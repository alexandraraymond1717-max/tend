<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tend — Life Design Companion</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,400;0,9..144,500;0,9..144,600;1,9..144,300;1,9..144,400&family=Outfit:wght@300;400;500&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-deep: #1a1916;
      --bg-warm: #252320;
      --bg-card: #2d2a26;
      --bg-elevated: #363330;
      
      --cream: #F5F0E8;
      --cream-soft: #E8E2D6;
      --cream-muted: #C4BEB2;
      
      --gold: #D4A574;
      --gold-soft: #E8C9A0;
      --gold-muted: #A67C4E;
      
      --sage: #8B9E7C;
      --sage-soft: #A8B89A;
      --sage-deep: #5C6B52;
      
      --terracotta: #C4836A;
      --terracotta-soft: #D9A88F;
      
      --lavender: #9B8AAE;
      --lavender-soft: #B8AAC8;
      
      --sky: #7A9CAD;
      --sky-soft: #9DBDCC;
      
      --rose: #C48B8B;
      --rose-soft: #D9ACAC;
    }

    body {
      font-family: 'Outfit', sans-serif;
      background-color: var(--bg-deep);
      color: var(--cream);
      line-height: 1.6;
      min-height: 100vh;
      font-weight: 300;
    }

    h1, h2, h3, h4 {
      font-family: 'Fraunces', serif;
      font-weight: 400;
    }

    /* Noise texture overlay */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0.03;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      z-index: 1000;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: transparent;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--bg-elevated);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--gold-muted);
    }

    /* Animations */
    @keyframes fadeUp {
      from { 
        opacity: 0; 
        transform: translateY(30px); 
      }
      to { 
        opacity: 1; 
        transform: translateY(0); 
      }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.8; }
    }

    @keyframes shimmer {
      0% { background-position: -200% center; }
      100% { background-position: 200% center; }
    }

    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .fade-up {
      animation: fadeUp 0.8s ease-out forwards;
    }

    .fade-in {
      animation: fadeIn 0.5s ease-out forwards;
    }

    /* Selection */
    ::selection {
      background: var(--gold);
      color: var(--bg-deep);
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // ============ CONSTANTS ============
    const SEASONS = {
      winter: { 
        name: 'Winter', 
        months: ['December', 'January', 'February'],
        color: 'var(--sky)',
        softColor: 'var(--sky-soft)',
        essence: 'rest & reflection',
        icon: '❋'
      },
      spring: { 
        name: 'Spring', 
        months: ['March', 'April', 'May'],
        color: 'var(--sage)',
        softColor: 'var(--sage-soft)',
        essence: 'growth & renewal',
        icon: '✿'
      },
      summer: { 
        name: 'Summer', 
        months: ['June', 'July', 'August'],
        color: 'var(--gold)',
        softColor: 'var(--gold-soft)',
        essence: 'abundance & joy',
        icon: '✺'
      },
      fall: { 
        name: 'Fall', 
        months: ['September', 'October', 'November'],
        color: 'var(--terracotta)',
        softColor: 'var(--terracotta-soft)',
        essence: 'harvest & release',
        icon: '✦'
      }
    };

    const EVENT_TYPES = {
      trip: { label: 'Trip', color: 'var(--sky)', icon: '↗' },
      rest: { label: 'Rest', color: 'var(--sage)', icon: '◠' },
      dateNight: { label: 'Date Night', color: 'var(--rose)', icon: '♡' },
      personal: { label: 'Personal', color: 'var(--lavender)', icon: '✧' },
      work: { label: 'Work', color: 'var(--cream-muted)', icon: '▫' },
      partner: { label: "Partner", color: 'var(--gold-muted)', icon: '◦' },
    };

    const VIEWS = {
      YEAR: 'year',
      SEASON: 'season',
      MONTH: 'month'
    };

    // ============ AI CONVERSATION FLOWS ============
    const AI_FLOWS = {
      year: {
        initial: "Welcome to a new chapter.\n\nBefore we fill any calendars, let's slow down. Close your eyes for a moment if you'd like.\n\nWhen you imagine looking back at this year from December 31st, what do you hope to feel? Not what you want to *accomplish*—but how you want the year to have *felt*.",
        followUps: [
          "That's beautiful. And what would need to be true for the year to feel that way? What would you need more of—or less of?",
          "I'm curious—when you think about that feeling, what images come to mind? What does a day look like when you're living in that energy?",
          "Is there anything you want to leave behind this year? Any patterns or ways of being that don't serve you anymore?",
          "Let's hold onto this. What would you call this year's theme if you had to give it a name? Just a word or a short phrase."
        ]
      },
      season: {
        winter: {
          initial: "Let's look at Winter—December through February.\n\nThis is traditionally a season of rest and reflection, of turning inward. The world slows down.\n\nWhat do you need from this winter? What would feel nourishing?",
          followUps: [
            "Winter often brings holidays and family. How do you want to navigate that this year?",
            "Is there something you want to start—a small practice, a project—that could benefit from the quiet of these months?"
          ]
        },
        spring: {
          initial: "Now, Spring—March through May.\n\nEnergy returns. Things that were dormant begin to wake up. It's a natural time for beginnings.\n\nWhat do you want to plant this spring? What seeds—literal or metaphorical—are you ready to nurture?",
          followUps: [
            "Spring often brings a restlessness, a desire to change everything at once. How do you want to pace yourself?",
            "Is there a trip or adventure that would feel aligned with this season of renewal?"
          ]
        },
        summer: {
          initial: "Summer—June through August.\n\nThe longest days. Warmth. Expansion. This is the season of fullness, of being out in the world.\n\nHow do you want to spend this abundant energy? What would make this summer feel alive?",
          followUps: [
            "Summer can also bring pressure to do it all, see everyone, make the most of every day. How do you want to balance openness with rest?",
            "Is there a big experience—a trip, a gathering, a celebration—that you want to prioritize?"
          ]
        },
        fall: {
          initial: "And Fall—September through November.\n\nThe world begins to release. Leaves fall. There's a natural invitation to let go, to harvest what you've grown, and to prepare for rest.\n\nWhat do you hope to be harvesting by fall? And what might you need to release?",
          followUps: [
            "Fall often brings a return to routine after summer's openness. What kind of rhythm do you want to settle into?",
            "Is there something you want to complete or bring to a close before the year ends?"
          ]
        }
      },
      month: {
        initial: "Now let's get specific.\n\nLooking at this month, what's already on your plate? And what do you want to make sure doesn't get lost in the busyness?",
        followUps: [
          "Where's the white space? Do you have enough room to breathe?",
          "Is there something you keep meaning to schedule but haven't? Let's put it on the timeline.",
          "How does this month balance with what you said you wanted for the season?"
        ]
      }
    };

    // ============ MAIN APP ============
    function TendApp() {
      const [currentView, setCurrentView] = useState(VIEWS.YEAR);
      const [currentSeason, setCurrentSeason] = useState('winter');
      const [currentMonth, setCurrentMonth] = useState(0);
      const [yearTheme, setYearTheme] = useState('');
      const [seasonIntentions, setSeasonIntentions] = useState({});
      const [events, setEvents] = useState([]);
      const [messages, setMessages] = useState([]);
      const [inputValue, setInputValue] = useState('');
      const [isTyping, setIsTyping] = useState(false);
      const [messageIndex, setMessageIndex] = useState(0);
      const [showEventModal, setShowEventModal] = useState(false);
      const messagesEndRef = useRef(null);

      useEffect(() => {
        // Initialize with year view message
        setMessages([{ role: 'assistant', content: AI_FLOWS.year.initial }]);
      }, []);

      useEffect(() => {
        messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
      }, [messages]);

      const handleSendMessage = () => {
        if (!inputValue.trim()) return;

        const userMessage = { role: 'user', content: inputValue };
        setMessages(prev => [...prev, userMessage]);
        setInputValue('');
        setIsTyping(true);

        setTimeout(() => {
          let response;
          if (currentView === VIEWS.YEAR) {
            response = AI_FLOWS.year.followUps[Math.min(messageIndex, AI_FLOWS.year.followUps.length - 1)];
          } else if (currentView === VIEWS.SEASON) {
            const seasonFlow = AI_FLOWS.season[currentSeason];
            response = seasonFlow.followUps[Math.min(messageIndex, seasonFlow.followUps.length - 1)];
          } else {
            response = AI_FLOWS.month.followUps[Math.min(messageIndex, AI_FLOWS.month.followUps.length - 1)];
          }
          
          setMessages(prev => [...prev, { role: 'assistant', content: response }]);
          setMessageIndex(prev => prev + 1);
          setIsTyping(false);
        }, 1500);
      };

      const progressToSeason = () => {
        setCurrentView(VIEWS.SEASON);
        setMessageIndex(0);
        const seasonFlow = AI_FLOWS.season[currentSeason];
        setMessages([{ role: 'assistant', content: seasonFlow.initial }]);
      };

      const progressToNextSeason = () => {
        const seasonOrder = ['winter', 'spring', 'summer', 'fall'];
        const currentIndex = seasonOrder.indexOf(currentSeason);
        if (currentIndex < seasonOrder.length - 1) {
          const nextSeason = seasonOrder[currentIndex + 1];
          setCurrentSeason(nextSeason);
          setMessageIndex(0);
          const seasonFlow = AI_FLOWS.season[nextSeason];
          setMessages([{ role: 'assistant', content: seasonFlow.initial }]);
        } else {
          progressToMonth();
        }
      };

      const progressToMonth = () => {
        setCurrentView(VIEWS.MONTH);
        setMessageIndex(0);
        setMessages([{ role: 'assistant', content: AI_FLOWS.month.initial }]);
      };

      const handleAddEvent = (eventData) => {
        setEvents(prev => [...prev, { ...eventData, id: Date.now() }]);
        setShowEventModal(false);
      };

      const handleDeleteEvent = (eventId) => {
        setEvents(prev => prev.filter(e => e.id !== eventId));
      };

      return (
        <div style={styles.container}>
          {/* Decorative elements */}
          <div style={styles.gradientOrb1} />
          <div style={styles.gradientOrb2} />
          
          {/* Header */}
          <header style={styles.header}>
            <div style={styles.logoContainer}>
              <h1 style={styles.logo}>tend</h1>
              <span style={styles.logoAccent}>✦</span>
            </div>
            <nav style={styles.nav}>
              <button 
                style={{
                  ...styles.navButton,
                  ...(currentView === VIEWS.YEAR && styles.navButtonActive)
                }}
                onClick={() => {
                  setCurrentView(VIEWS.YEAR);
                  setMessages([{ role: 'assistant', content: AI_FLOWS.year.initial }]);
                  setMessageIndex(0);
                }}
              >
                Year
              </button>
              <button 
                style={{
                  ...styles.navButton,
                  ...(currentView === VIEWS.SEASON && styles.navButtonActive)
                }}
                onClick={() => progressToSeason()}
              >
                Season
              </button>
              <button 
                style={{
                  ...styles.navButton,
                  ...(currentView === VIEWS.MONTH && styles.navButtonActive)
                }}
                onClick={() => progressToMonth()}
              >
                Month
              </button>
            </nav>
          </header>

          {/* Main Content */}
          <main style={styles.main}>
            {/* Visualization Panel */}
            <div style={styles.vizPanel}>
              {currentView === VIEWS.YEAR && <YearView yearTheme={yearTheme} />}
              {currentView === VIEWS.SEASON && (
                <SeasonView 
                  currentSeason={currentSeason} 
                  seasonIntentions={seasonIntentions}
                  onNextSeason={progressToNextSeason}
                />
              )}
              {currentView === VIEWS.MONTH && (
                <MonthView 
                  events={events}
                  onAddEvent={() => setShowEventModal(true)}
                  onDeleteEvent={handleDeleteEvent}
                />
              )}
            </div>

            {/* Chat Panel */}
            <div style={styles.chatPanel}>
              <div style={styles.chatMessages}>
                {messages.map((msg, idx) => (
                  <ChatMessage key={idx} message={msg} />
                ))}
                {isTyping && <TypingIndicator />}
                <div ref={messagesEndRef} />
              </div>
              
              <div style={styles.chatInputArea}>
                <textarea
                  style={styles.chatInput}
                  value={inputValue}
                  onChange={(e) => setInputValue(e.target.value)}
                  onKeyDown={(e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                      e.preventDefault();
                      handleSendMessage();
                    }
                  }}
                  placeholder="Share what's on your heart..."
                  rows={3}
                />
                <div style={styles.chatActions}>
                  {currentView === VIEWS.YEAR && (
                    <button style={styles.progressButton} onClick={progressToSeason}>
                      Continue to Seasons →
                    </button>
                  )}
                  {currentView === VIEWS.SEASON && (
                    <button style={styles.progressButton} onClick={progressToNextSeason}>
                      Next Season →
                    </button>
                  )}
                  <button 
                    style={styles.sendButton}
                    onClick={handleSendMessage}
                    disabled={!inputValue.trim()}
                  >
                    ↑
                  </button>
                </div>
              </div>
            </div>
          </main>

          {/* Event Modal */}
          {showEventModal && (
            <EventModal 
              onClose={() => setShowEventModal(false)}
              onAdd={handleAddEvent}
            />
          )}
        </div>
      );
    }

    // ============ YEAR VIEW ============
    function YearView({ yearTheme }) {
      const year = new Date().getFullYear();
      
      return (
        <div style={styles.yearView} className="fade-up">
          <div style={styles.yearNumber}>{year}</div>
          <div style={styles.yearCircle}>
            <svg viewBox="0 0 400 400" style={styles.yearSvg}>
              {/* Outer ring */}
              <circle cx="200" cy="200" r="180" fill="none" stroke="var(--bg-elevated)" strokeWidth="1" />
              <circle cx="200" cy="200" r="150" fill="none" stroke="var(--bg-elevated)" strokeWidth="1" />
              
              {/* Season arcs */}
              {Object.entries(SEASONS).map(([key, season], idx) => {
                const startAngle = idx * 90 - 90;
                const endAngle = startAngle + 90;
                const startRad = (startAngle * Math.PI) / 180;
                const endRad = (endAngle * Math.PI) / 180;
                const x1 = 200 + 165 * Math.cos(startRad);
                const y1 = 200 + 165 * Math.sin(startRad);
                const x2 = 200 + 165 * Math.cos(endRad);
                const y2 = 200 + 165 * Math.sin(endRad);
                
                return (
                  <g key={key}>
                    <path
                      d={`M ${x1} ${y1} A 165 165 0 0 1 ${x2} ${y2}`}
                      fill="none"
                      stroke={season.color}
                      strokeWidth="24"
                      opacity="0.6"
                      style={{
                        filter: 'blur(8px)',
                      }}
                    />
                    <path
                      d={`M ${x1} ${y1} A 165 165 0 0 1 ${x2} ${y2}`}
                      fill="none"
                      stroke={season.color}
                      strokeWidth="3"
                      opacity="0.9"
                    />
                  </g>
                );
              })}
              
              {/* Season labels */}
              {Object.entries(SEASONS).map(([key, season], idx) => {
                const angle = idx * 90 - 45;
                const rad = (angle * Math.PI) / 180;
                const x = 200 + 115 * Math.cos(rad);
                const y = 200 + 115 * Math.sin(rad);
                
                return (
                  <g key={`label-${key}`}>
                    <text
                      x={x}
                      y={y - 8}
                      textAnchor="middle"
                      fill={season.color}
                      style={{ 
                        fontFamily: "'Fraunces', serif",
                        fontSize: '14px',
                        fontWeight: 400
                      }}
                    >
                      {season.name}
                    </text>
                    <text
                      x={x}
                      y={y + 12}
                      textAnchor="middle"
                      fill="var(--cream-muted)"
                      style={{ 
                        fontFamily: "'Outfit', sans-serif",
                        fontSize: '10px',
                        fontWeight: 300
                      }}
                    >
                      {season.essence}
                    </text>
                  </g>
                );
              })}
              
              {/* Center */}
              <circle cx="200" cy="200" r="50" fill="var(--bg-card)" />
              <text
                x="200"
                y="195"
                textAnchor="middle"
                fill="var(--cream)"
                style={{ 
                  fontFamily: "'Fraunces', serif",
                  fontSize: '12px',
                }}
              >
                your
              </text>
              <text
                x="200"
                y="212"
                textAnchor="middle"
                fill="var(--gold)"
                style={{ 
                  fontFamily: "'Fraunces', serif",
                  fontSize: '14px',
                  fontStyle: 'italic'
                }}
              >
                year
              </text>
            </svg>
          </div>
          
          <p style={styles.yearPrompt}>
            What do you want this year to feel like?
          </p>
        </div>
      );
    }

    // ============ SEASON VIEW ============
    function SeasonView({ currentSeason, seasonIntentions, onNextSeason }) {
      const season = SEASONS[currentSeason];
      
      return (
        <div style={styles.seasonView} className="fade-up">
          <div style={styles.seasonHeader}>
            <span style={{...styles.seasonIcon, color: season.color}}>{season.icon}</span>
            <h2 style={{...styles.seasonName, color: season.color}}>{season.name}</h2>
            <p style={styles.seasonEssence}>{season.essence}</p>
          </div>
          
          <div style={styles.seasonMonths}>
            {season.months.map((month, idx) => (
              <div 
                key={month} 
                style={{
                  ...styles.seasonMonth,
                  animationDelay: `${idx * 0.15}s`,
                  borderColor: season.color,
                }}
                className="fade-up"
              >
                <span style={styles.seasonMonthName}>{month}</span>
              </div>
            ))}
          </div>

          <div style={styles.seasonQuote}>
            <span style={{color: season.color}}>"</span>
            {currentSeason === 'winter' && "In the depth of winter, I finally learned that within me there lay an invincible summer."}
            {currentSeason === 'spring' && "Spring adds new life and new beauty to all that is."}
            {currentSeason === 'summer' && "In summer, the song sings itself."}
            {currentSeason === 'fall' && "Autumn shows us how beautiful it is to let things go."}
            <span style={{color: season.color}}>"</span>
          </div>
        </div>
      );
    }

    // ============ MONTH VIEW ============
    function MonthView({ events, onAddEvent, onDeleteEvent }) {
      const now = new Date();
      const currentMonth = now.getMonth();
      const currentYear = now.getFullYear();
      const monthName = ['January', 'February', 'March', 'April', 'May', 'June', 
                         'July', 'August', 'September', 'October', 'November', 'December'][currentMonth];
      const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
      const firstDay = new Date(currentYear, currentMonth, 1).getDay();

      const getEventsForDay = (day) => {
        const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        return events.filter(e => {
          const start = new Date(e.startDate);
          const end = new Date(e.endDate);
          const current = new Date(dateStr);
          return current >= start && current <= end;
        });
      };

      return (
        <div style={styles.monthView} className="fade-up">
          <div style={styles.monthHeader}>
            <h2 style={styles.monthName}>{monthName}</h2>
            <span style={styles.monthYear}>{currentYear}</span>
          </div>

          <div style={styles.calendarGrid}>
            {['S', 'M', 'T', 'W', 'T', 'F', 'S'].map((day, idx) => (
              <div key={idx} style={styles.calendarDayHeader}>{day}</div>
            ))}
            
            {Array.from({ length: firstDay }, (_, i) => (
              <div key={`empty-${i}`} style={styles.calendarDayEmpty} />
            ))}
            
            {Array.from({ length: daysInMonth }, (_, i) => {
              const day = i + 1;
              const dayEvents = getEventsForDay(day);
              const isToday = day === now.getDate();
              
              return (
                <div 
                  key={day} 
                  style={{
                    ...styles.calendarDay,
                    ...(isToday && styles.calendarDayToday),
                    ...(dayEvents.length > 0 && {
                      backgroundColor: 'var(--bg-elevated)',
                    })
                  }}
                >
                  <span style={{
                    ...styles.calendarDayNumber,
                    ...(isToday && styles.calendarDayNumberToday)
                  }}>{day}</span>
                  {dayEvents.length > 0 && (
                    <div style={styles.calendarDayDots}>
                      {dayEvents.slice(0, 3).map((event, idx) => (
                        <span 
                          key={idx} 
                          style={{
                            ...styles.calendarDayDot,
                            backgroundColor: EVENT_TYPES[event.type].color
                          }}
                        />
                      ))}
                    </div>
                  )}
                </div>
              );
            })}
          </div>

          <div style={styles.eventsList}>
            <div style={styles.eventsHeader}>
              <h3 style={styles.eventsTitle}>This Month</h3>
              <button style={styles.addEventButton} onClick={onAddEvent}>
                + Add moment
              </button>
            </div>
            
            {events.length === 0 ? (
              <p style={styles.eventsEmpty}>
                No moments planned yet.<br/>
                <span style={styles.eventsEmptyHint}>What do you want to make space for?</span>
              </p>
            ) : (
              <div style={styles.eventsGrid}>
                {events.map(event => (
                  <div 
                    key={event.id} 
                    style={{
                      ...styles.eventCard,
                      borderLeftColor: EVENT_TYPES[event.type].color
                    }}
                  >
                    <div style={styles.eventCardHeader}>
                      <span style={{
                        ...styles.eventCardIcon,
                        color: EVENT_TYPES[event.type].color
                      }}>
                        {EVENT_TYPES[event.type].icon}
                      </span>
                      <span style={styles.eventCardType}>{EVENT_TYPES[event.type].label}</span>
                      {event.isShared && <span style={styles.eventCardShared}>shared</span>}
                    </div>
                    <h4 style={styles.eventCardTitle}>{event.title}</h4>
                    <p style={styles.eventCardDate}>
                      {new Date(event.startDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                      {event.startDate !== event.endDate && (
                        <> – {new Date(event.endDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</>
                      )}
                    </p>
                    <button 
                      style={styles.eventCardDelete}
                      onClick={() => onDeleteEvent(event.id)}
                    >
                      ×
                    </button>
                  </div>
                ))}
              </div>
            )}
          </div>
        </div>
      );
    }

    // ============ CHAT COMPONENTS ============
    function ChatMessage({ message }) {
      const isAssistant = message.role === 'assistant';
      
      return (
        <div style={{
          ...styles.chatMessage,
          ...(isAssistant ? styles.chatMessageAssistant : styles.chatMessageUser)
        }} className="fade-in">
          {isAssistant && (
            <div style={styles.chatAvatar}>
              <span style={styles.chatAvatarText}>T</span>
            </div>
          )}
          <div style={{
            ...styles.chatBubble,
            ...(isAssistant ? styles.chatBubbleAssistant : styles.chatBubbleUser)
          }}>
            {message.content.split('\n').map((line, i) => (
              <p key={i} style={{ marginBottom: line ? '0.75rem' : '0' }}>
                {line}
              </p>
            ))}
          </div>
        </div>
      );
    }

    function TypingIndicator() {
      return (
        <div style={styles.chatMessage} className="fade-in">
          <div style={styles.chatAvatar}>
            <span style={styles.chatAvatarText}>T</span>
          </div>
          <div style={styles.typingBubble}>
            <span style={{...styles.typingDot, animationDelay: '0s'}}>•</span>
            <span style={{...styles.typingDot, animationDelay: '0.15s'}}>•</span>
            <span style={{...styles.typingDot, animationDelay: '0.3s'}}>•</span>
          </div>
        </div>
      );
    }

    // ============ EVENT MODAL ============
    function EventModal({ onClose, onAdd }) {
      const [title, setTitle] = useState('');
      const [type, setType] = useState('trip');
      const [startDate, setStartDate] = useState('');
      const [endDate, setEndDate] = useState('');
      const [isShared, setIsShared] = useState(false);

      const handleSubmit = (e) => {
        e.preventDefault();
        if (!title || !startDate || !endDate) return;
        onAdd({ title, type, startDate, endDate, isShared });
      };

      return (
        <div style={styles.modalOverlay} onClick={onClose}>
          <div style={styles.modal} onClick={e => e.stopPropagation()} className="fade-up">
            <div style={styles.modalHeader}>
              <h3 style={styles.modalTitle}>Add a moment</h3>
              <button style={styles.modalClose} onClick={onClose}>×</button>
            </div>
            
            <form onSubmit={handleSubmit} style={styles.modalForm}>
              <div style={styles.formField}>
                <label style={styles.formLabel}>What is it?</label>
                <input
                  type="text"
                  style={styles.formInput}
                  value={title}
                  onChange={(e) => setTitle(e.target.value)}
                  placeholder="Weekend getaway, date night, rest day..."
                />
              </div>

              <div style={styles.formField}>
                <label style={styles.formLabel}>Type</label>
                <div style={styles.typeSelector}>
                  {Object.entries(EVENT_TYPES).map(([key, value]) => (
                    <button
                      key={key}
                      type="button"
                      style={{
                        ...styles.typeOption,
                        ...(type === key && {
                          borderColor: value.color,
                          backgroundColor: 'var(--bg-elevated)',
                        })
                      }}
                      onClick={() => setType(key)}
                    >
                      <span style={{ color: value.color }}>{value.icon}</span>
                      <span>{value.label}</span>
                    </button>
                  ))}
                </div>
              </div>

              <div style={styles.formRow}>
                <div style={styles.formField}>
                  <label style={styles.formLabel}>Start</label>
                  <input
                    type="date"
                    style={styles.formInput}
                    value={startDate}
                    onChange={(e) => setStartDate(e.target.value)}
                  />
                </div>
                <div style={styles.formField}>
                  <label style={styles.formLabel}>End</label>
                  <input
                    type="date"
                    style={styles.formInput}
                    value={endDate}
                    onChange={(e) => setEndDate(e.target.value)}
                  />
                </div>
              </div>

              <label style={styles.checkboxLabel}>
                <input
                  type="checkbox"
                  checked={isShared}
                  onChange={(e) => setIsShared(e.target.checked)}
                  style={styles.checkbox}
                />
                <span>This is shared with my partner</span>
              </label>

              <button 
                type="submit" 
                style={styles.submitButton}
                disabled={!title || !startDate || !endDate}
              >
                Add to timeline
              </button>
            </form>
          </div>
        </div>
      );
    }

    // ============ STYLES ============
    const styles = {
      container: {
        minHeight: '100vh',
        position: 'relative',
        overflow: 'hidden',
      },
      gradientOrb1: {
        position: 'fixed',
        top: '-20%',
        right: '-10%',
        width: '50vw',
        height: '50vw',
        borderRadius: '50%',
        background: 'radial-gradient(circle, var(--gold-muted) 0%, transparent 70%)',
        opacity: 0.15,
        pointerEvents: 'none',
        filter: 'blur(60px)',
      },
      gradientOrb2: {
        position: 'fixed',
        bottom: '-30%',
        left: '-20%',
        width: '60vw',
        height: '60vw',
        borderRadius: '50%',
        background: 'radial-gradient(circle, var(--sage-deep) 0%, transparent 70%)',
        opacity: 0.1,
        pointerEvents: 'none',
        filter: 'blur(80px)',
      },
      header: {
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'center',
        padding: '1.5rem 3rem',
        borderBottom: '1px solid var(--bg-elevated)',
        position: 'relative',
        zIndex: 10,
      },
      logoContainer: {
        display: 'flex',
        alignItems: 'center',
        gap: '0.5rem',
      },
      logo: {
        fontSize: '1.75rem',
        fontFamily: "'Fraunces', serif",
        fontWeight: 400,
        color: 'var(--cream)',
        letterSpacing: '0.02em',
      },
      logoAccent: {
        color: 'var(--gold)',
        fontSize: '0.75rem',
        marginTop: '-0.5rem',
      },
      nav: {
        display: 'flex',
        gap: '0.5rem',
      },
      navButton: {
        padding: '0.5rem 1.25rem',
        backgroundColor: 'transparent',
        border: '1px solid var(--bg-elevated)',
        borderRadius: '24px',
        color: 'var(--cream-muted)',
        fontSize: '0.875rem',
        fontFamily: "'Outfit', sans-serif",
        fontWeight: 400,
        cursor: 'pointer',
        transition: 'all 0.3s ease',
      },
      navButtonActive: {
        backgroundColor: 'var(--bg-elevated)',
        borderColor: 'var(--gold-muted)',
        color: 'var(--cream)',
      },
      main: {
        display: 'grid',
        gridTemplateColumns: '1fr 400px',
        height: 'calc(100vh - 73px)',
        position: 'relative',
        zIndex: 10,
      },
      vizPanel: {
        padding: '3rem',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        overflow: 'auto',
      },
      chatPanel: {
        backgroundColor: 'var(--bg-warm)',
        borderLeft: '1px solid var(--bg-elevated)',
        display: 'flex',
        flexDirection: 'column',
      },
      chatMessages: {
        flex: 1,
        padding: '1.5rem',
        overflowY: 'auto',
        display: 'flex',
        flexDirection: 'column',
        gap: '1.25rem',
      },
      chatMessage: {
        display: 'flex',
        gap: '0.75rem',
        alignItems: 'flex-start',
      },
      chatMessageAssistant: {
        justifyContent: 'flex-start',
      },
      chatMessageUser: {
        justifyContent: 'flex-end',
      },
      chatAvatar: {
        width: '32px',
        height: '32px',
        borderRadius: '50%',
        backgroundColor: 'var(--bg-elevated)',
        border: '1px solid var(--gold-muted)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        flexShrink: 0,
      },
      chatAvatarText: {
        fontFamily: "'Fraunces', serif",
        fontSize: '0.875rem',
        color: 'var(--gold)',
      },
      chatBubble: {
        padding: '1rem 1.25rem',
        borderRadius: '16px',
        maxWidth: '85%',
        fontSize: '0.9rem',
        lineHeight: 1.7,
      },
      chatBubbleAssistant: {
        backgroundColor: 'var(--bg-card)',
        borderTopLeftRadius: '4px',
        color: 'var(--cream)',
      },
      chatBubbleUser: {
        backgroundColor: 'var(--gold-muted)',
        borderTopRightRadius: '4px',
        color: 'var(--cream)',
      },
      typingBubble: {
        padding: '1rem 1.25rem',
        backgroundColor: 'var(--bg-card)',
        borderRadius: '16px',
        borderTopLeftRadius: '4px',
        display: 'flex',
        gap: '4px',
      },
      typingDot: {
        color: 'var(--gold)',
        fontSize: '1.25rem',
        lineHeight: 1,
        animation: 'pulse 1s infinite',
      },
      chatInputArea: {
        padding: '1rem 1.5rem 1.5rem',
        borderTop: '1px solid var(--bg-elevated)',
      },
      chatInput: {
        width: '100%',
        padding: '1rem',
        backgroundColor: 'var(--bg-card)',
        border: '1px solid var(--bg-elevated)',
        borderRadius: '12px',
        color: 'var(--cream)',
        fontSize: '0.9rem',
        fontFamily: "'Outfit', sans-serif",
        fontWeight: 300,
        resize: 'none',
        outline: 'none',
        transition: 'border-color 0.3s ease',
        marginBottom: '0.75rem',
      },
      chatActions: {
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'center',
      },
      progressButton: {
        padding: '0.5rem 1rem',
        backgroundColor: 'transparent',
        border: '1px solid var(--gold-muted)',
        borderRadius: '20px',
        color: 'var(--gold)',
        fontSize: '0.8rem',
        fontFamily: "'Outfit', sans-serif",
        cursor: 'pointer',
        transition: 'all 0.3s ease',
      },
      sendButton: {
        width: '40px',
        height: '40px',
        borderRadius: '50%',
        backgroundColor: 'var(--gold-muted)',
        border: 'none',
        color: 'var(--cream)',
        fontSize: '1.25rem',
        cursor: 'pointer',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        transition: 'all 0.3s ease',
        marginLeft: 'auto',
      },

      // Year View
      yearView: {
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        gap: '2rem',
      },
      yearNumber: {
        fontSize: '5rem',
        fontFamily: "'Fraunces', serif",
        fontWeight: 300,
        color: 'var(--cream)',
        letterSpacing: '-0.02em',
        opacity: 0.9,
      },
      yearCircle: {
        width: '400px',
        height: '400px',
      },
      yearSvg: {
        width: '100%',
        height: '100%',
      },
      yearPrompt: {
        fontSize: '1.125rem',
        color: 'var(--cream-muted)',
        fontStyle: 'italic',
        textAlign: 'center',
      },

      // Season View
      seasonView: {
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        gap: '3rem',
        textAlign: 'center',
        maxWidth: '600px',
      },
      seasonHeader: {
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        gap: '0.5rem',
      },
      seasonIcon: {
        fontSize: '3rem',
        marginBottom: '0.5rem',
      },
      seasonName: {
        fontSize: '3.5rem',
        fontFamily: "'Fraunces', serif",
        fontWeight: 400,
      },
      seasonEssence: {
        fontSize: '1.125rem',
        color: 'var(--cream-muted)',
        fontStyle: 'italic',
      },
      seasonMonths: {
        display: 'flex',
        gap: '1rem',
      },
      seasonMonth: {
        padding: '1rem 2rem',
        backgroundColor: 'var(--bg-card)',
        borderRadius: '12px',
        border: '1px solid',
        opacity: 0,
        animation: 'fadeUp 0.6s ease-out forwards',
      },
      seasonMonthName: {
        fontSize: '1rem',
        color: 'var(--cream)',
        fontWeight: 400,
      },
      seasonQuote: {
        fontSize: '1rem',
        color: 'var(--cream-muted)',
        fontStyle: 'italic',
        maxWidth: '400px',
        lineHeight: 1.8,
      },

      // Month View
      monthView: {
        width: '100%',
        maxWidth: '700px',
      },
      monthHeader: {
        display: 'flex',
        alignItems: 'baseline',
        gap: '1rem',
        marginBottom: '2rem',
      },
      monthName: {
        fontSize: '2.5rem',
        fontFamily: "'Fraunces', serif",
        fontWeight: 400,
        color: 'var(--cream)',
      },
      monthYear: {
        fontSize: '1.25rem',
        color: 'var(--cream-muted)',
      },
      calendarGrid: {
        display: 'grid',
        gridTemplateColumns: 'repeat(7, 1fr)',
        gap: '4px',
        marginBottom: '2rem',
      },
      calendarDayHeader: {
        padding: '0.5rem',
        textAlign: 'center',
        color: 'var(--cream-muted)',
        fontSize: '0.75rem',
        fontWeight: 500,
      },
      calendarDayEmpty: {
        aspectRatio: '1',
      },
      calendarDay: {
        aspectRatio: '1',
        backgroundColor: 'var(--bg-card)',
        borderRadius: '8px',
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        justifyContent: 'center',
        gap: '4px',
        cursor: 'pointer',
        transition: 'all 0.2s ease',
        position: 'relative',
      },
      calendarDayToday: {
        border: '1px solid var(--gold)',
      },
      calendarDayNumber: {
        fontSize: '0.875rem',
        color: 'var(--cream-muted)',
      },
      calendarDayNumberToday: {
        color: 'var(--gold)',
        fontWeight: 500,
      },
      calendarDayDots: {
        display: 'flex',
        gap: '3px',
        position: 'absolute',
        bottom: '6px',
      },
      calendarDayDot: {
        width: '5px',
        height: '5px',
        borderRadius: '50%',
      },
      eventsList: {
        backgroundColor: 'var(--bg-card)',
        borderRadius: '16px',
        padding: '1.5rem',
      },
      eventsHeader: {
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'center',
        marginBottom: '1rem',
      },
      eventsTitle: {
        fontSize: '1.125rem',
        fontFamily: "'Fraunces', serif",
        color: 'var(--cream)',
      },
      addEventButton: {
        padding: '0.5rem 1rem',
        backgroundColor: 'var(--gold-muted)',
        border: 'none',
        borderRadius: '20px',
        color: 'var(--cream)',
        fontSize: '0.8rem',
        fontFamily: "'Outfit', sans-serif",
        cursor: 'pointer',
        transition: 'all 0.3s ease',
      },
      eventsEmpty: {
        color: 'var(--cream-muted)',
        textAlign: 'center',
        padding: '2rem',
        fontSize: '0.9rem',
      },
      eventsEmptyHint: {
        color: 'var(--gold-muted)',
        fontStyle: 'italic',
      },
      eventsGrid: {
        display: 'flex',
        flexDirection: 'column',
        gap: '0.75rem',
      },
      eventCard: {
        backgroundColor: 'var(--bg-elevated)',
        borderRadius: '10px',
        padding: '1rem',
        borderLeft: '3px solid',
        position: 'relative',
      },
      eventCardHeader: {
        display: 'flex',
        alignItems: 'center',
        gap: '0.5rem',
        marginBottom: '0.5rem',
      },
      eventCardIcon: {
        fontSize: '0.875rem',
      },
      eventCardType: {
        fontSize: '0.75rem',
        color: 'var(--cream-muted)',
        textTransform: 'uppercase',
        letterSpacing: '0.05em',
      },
      eventCardShared: {
        fontSize: '0.65rem',
        padding: '0.125rem 0.5rem',
        backgroundColor: 'var(--bg-card)',
        borderRadius: '10px',
        color: 'var(--cream-muted)',
        marginLeft: 'auto',
      },
      eventCardTitle: {
        fontSize: '1rem',
        color: 'var(--cream)',
        fontFamily: "'Outfit', sans-serif",
        fontWeight: 400,
        marginBottom: '0.25rem',
      },
      eventCardDate: {
        fontSize: '0.8rem',
        color: 'var(--cream-muted)',
      },
      eventCardDelete: {
        position: 'absolute',
        top: '0.75rem',
        right: '0.75rem',
        width: '24px',
        height: '24px',
        borderRadius: '50%',
        backgroundColor: 'transparent',
        border: 'none',
        color: 'var(--cream-muted)',
        fontSize: '1.25rem',
        cursor: 'pointer',
        opacity: 0.5,
        transition: 'opacity 0.2s ease',
      },

      // Modal
      modalOverlay: {
        position: 'fixed',
        top: 0,
        left: 0,
        right: 0,
        bottom: 0,
        backgroundColor: 'rgba(0,0,0,0.7)',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        zIndex: 1000,
        backdropFilter: 'blur(4px)',
      },
      modal: {
        backgroundColor: 'var(--bg-card)',
        borderRadius: '20px',
        padding: '2rem',
        width: '90%',
        maxWidth: '450px',
        border: '1px solid var(--bg-elevated)',
      },
      modalHeader: {
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'center',
        marginBottom: '1.5rem',
      },
      modalTitle: {
        fontSize: '1.5rem',
        fontFamily: "'Fraunces', serif",
        color: 'var(--cream)',
      },
      modalClose: {
        width: '32px',
        height: '32px',
        borderRadius: '50%',
        backgroundColor: 'var(--bg-elevated)',
        border: 'none',
        color: 'var(--cream-muted)',
        fontSize: '1.25rem',
        cursor: 'pointer',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
      },
      modalForm: {
        display: 'flex',
        flexDirection: 'column',
        gap: '1.25rem',
      },
      formField: {
        display: 'flex',
        flexDirection: 'column',
        gap: '0.5rem',
      },
      formRow: {
        display: 'grid',
        gridTemplateColumns: '1fr 1fr',
        gap: '1rem',
      },
      formLabel: {
        fontSize: '0.8rem',
        color: 'var(--cream-muted)',
        textTransform: 'uppercase',
        letterSpacing: '0.05em',
      },
      formInput: {
        padding: '0.875rem 1rem',
        backgroundColor: 'var(--bg-elevated)',
        border: '1px solid var(--bg-elevated)',
        borderRadius: '10px',
        color: 'var(--cream)',
        fontSize: '0.9rem',
        fontFamily: "'Outfit', sans-serif",
        outline: 'none',
        transition: 'border-color 0.3s ease',
      },
      typeSelector: {
        display: 'grid',
        gridTemplateColumns: 'repeat(3, 1fr)',
        gap: '0.5rem',
      },
      typeOption: {
        padding: '0.75rem 0.5rem',
        backgroundColor: 'var(--bg-elevated)',
        border: '1px solid var(--bg-elevated)',
        borderRadius: '10px',
        color: 'var(--cream)',
        fontSize: '0.75rem',
        fontFamily: "'Outfit', sans-serif",
        cursor: 'pointer',
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        gap: '0.25rem',
        transition: 'all 0.2s ease',
      },
      checkboxLabel: {
        display: 'flex',
        alignItems: 'center',
        gap: '0.75rem',
        fontSize: '0.9rem',
        color: 'var(--cream-muted)',
        cursor: 'pointer',
      },
      checkbox: {
        width: '18px',
        height: '18px',
        accentColor: 'var(--gold)',
      },
      submitButton: {
        padding: '1rem',
        backgroundColor: 'var(--gold-muted)',
        border: 'none',
        borderRadius: '12px',
        color: 'var(--cream)',
        fontSize: '0.9rem',
        fontFamily: "'Outfit', sans-serif",
        fontWeight: 500,
        cursor: 'pointer',
        transition: 'all 0.3s ease',
        marginTop: '0.5rem',
      },
    };

    // ============ RENDER ============
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<TendApp />);
  </script>
</body>
</html>
